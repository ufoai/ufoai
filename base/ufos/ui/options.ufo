// =============
// OPTIONS MENU
// =============

/*
 * @TODO
 * - Joystick options
 * - Add new tab for mods
 */

component KeyBinding extends panel {
	{
		size 	"315 25"
		layout	LAYOUT_LEFT_RIGHT_FLOW
	}
	data id {
		integer	-1
	}
	string key {
		size	"130 25"
		font	"f_verysmall_bold"
	}
	string description {
		size	"185 25"
		font	"f_verysmall_bold"
	}
}

component KeyList extends panel {
	{
		size	"335 360"
	}
	panel list {
		{
			size	"335 360"
			layout	LAYOUT_TOP_DOWN_FLOW
		}
		string label
		{
			size		"335 30"
			font		"f_small_bold"
			bgcolor		"0.4 0.52 0.5 1"
			color		"0.065 0.065 0.065 1"
			contentalign	ALIGN_CC
		}
		panel keylist {
			size	"315 330"
			layout	LAYOUT_TOP_DOWN_FLOW
			wheelscrollable	true
			onViewChange {
				*node:this.parent.parent.keylist_scroll@fullsize = <fullsize>
				*node:this.parent.parent.keylist_scroll@current = <viewpos>
				*node:this.parent.parent.keylist_scroll@viewsize = <viewsize>
			}
		}
	}
	vscrollbar keylist_scroll {
		image		"ui/scrollbar_v"
		pos			"317 30"
		height		"330"
		hidewhenunused true
		onChange {
			*node:this.parent.list.keylist@viewpos = <current>
		}
	}
}

window options
{
	{
		background	"ui/main_bg"
//		noticepos	"512 110"
	}

	// Toolbar across the top of the screen
	MainMenuToolbar mmtoolbar { }

	panel opts_windows
	{
		{
			size		"1024 435"
			pos			"0 90"
			bgcolor		"0.4 0.52 0.5 0.2"
		}

		/*
		 * Hides all windows and shows selected one
		 */
		func hidepanels
		{
			*node:parent.opts_general@invis = true
			*node:parent.opts_general_btn@bgcolor = "0.4 0.515 0.5 0.25"
			*node:parent.opts_general_btn@color = "1 1 1 0.5"
			*node:parent.opts_video@invis = true
			*node:parent.opts_video_btn@bgcolor = "0.4 0.515 0.5 0.25"
			*node:parent.opts_video_btn@color = "1 1 1 0.5"
			*node:parent.opts_sound@invis = true
			*node:parent.opts_sound_btn@bgcolor = "0.4 0.515 0.5 0.25"
			*node:parent.opts_sound_btn@color = "1 1 1 0.5"
			*node:parent.opts_gameplay@invis = true
			*node:parent.opts_gameplay_btn@bgcolor = "0.4 0.515 0.5 0.25"
			*node:parent.opts_gameplay_btn@color = "1 1 1 0.5"
			*node:parent.opts_keys@invis = true
			*node:parent.opts_keys_btn@bgcolor = "0.4 0.515 0.5 0.25"
			*node:parent.opts_keys_btn@color = "1 1 1 0.5"
		}

		MainMenuTab opts_general_btn
		{
			pos 		"0 0"
			string		"_GENERAL"
			bgcolor		"0.4 0.515 0.5 1"
			color		"0 0 0 0.9"
			onClick		{
				call *node:root.opts_windows.hidepanels
				*node:parent.opts_general@invis = false
				*node:this@bgcolor = "0.4 0.515 0.5 1"
				*node:this@color =  "0 0 0 0.9"
			}
		}

		MainMenuTab opts_video_btn
		{
			pos 		"135 0"
			string		"_VIDEO"
			onClick		{
				call *node:parent.hidepanels
				*node:parent.opts_video@invis = false
				*node:this@bgcolor = "0.4 0.515 0.5 1"
				*node:this@color =  "0 0 0 0.9"
			}
		}

		MainMenuTab opts_sound_btn
		{
			pos 		"270 0"
			string		"_SOUND"
			onClick		{
				call *node:root.opts_windows.hidepanels
				*node:parent.opts_sound@invis = false
				*node:this@bgcolor = "0.4 0.515 0.5 1"
				*node:this@color =  "0 0 0 0.9"
			}
		}

		MainMenuTab opts_keys_btn
		{
			pos 		"405 0"
			string		"_KEYS"
			onClick		{
				call *node:root.opts_windows.hidepanels
				*node:parent.opts_keys@invis = false
				*node:this@bgcolor = "0.4 0.515 0.5 1"
				*node:this@color =  "0 0 0 0.9"
			}
		}

		MainMenuTab opts_gameplay_btn
		{
			pos 		"540 0"
			string		"_GAMEPLAY"
			onClick		{
				call *node:root.opts_windows.hidepanels
				*node:parent.opts_gameplay@invis = false
				*node:this@bgcolor = "0.4 0.515 0.5 1"
				*node:this@color =  "0 0 0 0.9"
			}
		}

		MainMenuExitBtn btn_back_btn
		{
			size 			"250 30"
			pos 			"774 405"
			string			"_DONE"
			onClick			{ cmd "ui_pop;" }
		}

		// ===============
		// GENERAL OPTIONS
		// ===============
		panel opts_general
		{
			{
				pos 	"0 40"
				size	"1024 365"
			}

			// Change the player's name
			panel player_name
			{
				{
					pos		"0 0"
					size	"512 30"
					onMouseEnter 	{ *node:this.name_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.name_label@color = "1 1 1 0.5" }
				}
				string name_label
				{
					string 			"_Name"
					pos				"5 5"
					size			"256 20"
					color			"1 1 1 0.5"
				}
				TextEntry slot_name
				{
					string			*cvar:cl_name
					pos				"292 5"
					size			"200 20"
				}
			}

			// Change the language used
			panel language
			{
				{
					pos		"0 30"
					size	"512 145"
					onMouseEnter 	{ *node:this.lng_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.lng_label@color = "1 1 1 0.5" }
				}
				string lng_label
				{
					string			"_Language Settings"
					pos				"5 5"
					size			"256 20"
					color			"1 1 1 0.5"
				}
				optionlist select_language
				{
					dataid			OPTION_LANGUAGES
					pos				"292 5"
					font			"f_language"
					size			"200 135"
					cvar			*cvar:s_language
					background			"ui/panel"
					color			"1 1 1 0.5"
					selectcolor		"1 1 1 0.9"
					padding			6
					contentalign	ALIGN_CC
					onViewChange	{
						*node:parent.select_language_scroll@current = <viewpos>
						*node:parent.select_language_scroll@fullsize = <fullsize>
						*node:parent.select_language_scroll@viewsize = <viewsize>
					}
				}
				vscrollbar select_language_scroll {
					image		"ui/scrollbar_v"
					pos			"472 5"
					height		"135"
					current		0
					viewsize	8
					fullsize	8
					onChange		{
						*node:parent.select_language@viewpos = <current>
					}
				}
			}

			// Mouseover tooltips options
			panel mtooltips
			{
				{
					pos		"0 175"
					size	"512 30"
					onMouseEnter 	{ *node:this.mtooltips_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.mtooltips_label@color = "1 1 1 0.5" }
				}

				string mtooltips_label
				{
					string		"_Tooltips"
					pos			"5 5"
					size		"450 20"
					color		"1 1 1 0.5"
				}

				CheckBox mtooltips_opt
				{
					current		*cvar:mn_show_tooltips
					pos			"472 6"
					size		"20 18"
				}
			}

			// Cursor tooltips options
			panel ctooltips
			{
				{
					pos		"0 205"
					size	"512 30"
					onMouseEnter 	{ *node:this.ctooltips_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.ctooltips_label@color = "1 1 1 0.5" }
				}

				string ctooltips_label
				{
					string		"_Cursor tooltips"
					pos			"5 5"
					size		"450 20"
					color		"1 1 1 0.5"
				}

				CheckBox ctooltips_opt
				{
					current		*cvar:cl_show_cursor_tooltips
					pos			"472 6"
					size		"20 18"
				}
			}

			// Tip of the day options
			panel tipoftheday
			{
				{
					pos		"0 235"
					size	"512 30"
					onMouseEnter 	{ *node:this.tipoftheday_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.tipoftheday_label@color = "1 1 1 0.5" }
				}

				string tipoftheday_label
				{
					string		"_Main menu tips"
					pos			"5 5"
					size		"450 20"
					color		"1 1 1 0.5"
				}

				CheckBox tipoftheday_opt
				{
					current		*cvar:cl_showTipOfTheDay
					pos			"472 6"
					size		"20 18"
				}
			}

			// Pre-cache menu models
			panel precache
			{
				{
					pos		"0 265"
					size	"512 30"
					onMouseEnter 	{ *node:this.precache_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.precache_label@color = "1 1 1 0.5" }
				}

				string precache_label
				{
					string		"_Pre-cache menu models"
					tooltip		"_Increases speed of game menus"
					pos			"5 5"
					size		"450 20"
					color		"1 1 1 0.5"
				}

				CheckBox precache_opt
				{
					current		*cvar:cl_precache
					pos			"472 6"
					size		"20 18"
				}
			}

			// ===============
			// GENERAL OPTIONS
			// Second Column
			// ===============
			string geoscape_opts_label
			{
				string		"_Geoscape Options"
				pos			"512 0"
				size		"512 30"
				font		"f_small_bold"
				bgcolor		"0.4 0.52 0.5 1"
				color		"0.065 0.065 0.065 1"
				contentalign	ALIGN_CC
			}

			// 3D Geoscape
			panel geo3d
			{
				{
					pos		"512 40"
					size	"512 30"
					onMouseEnter 	{ *node:this.geo3d_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.geo3d_label@color = "1 1 1 0.5" }
				}

				string geo3d_label
				{
					string		"_3D geoscape"
					tooltip		"_View the geoscape as a 3D globe"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox geo3d_opt
				{
					current		*cvar:cl_3dmap
					pos			"472 6"
					size		"20 18"
				}
			}

			// 3D Geoscape camera zoom minimum and maximums
			panel geo_camera_zoom
			{
				{
					pos		"512 70"
					size	"512 30"
					onMouseEnter 	{ *node:this.geo_camera_zoom_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.geo_camera_zoom_label@color = "1 1 1 0.5" }
				}

				string geo_camera_zoom_label
				{
					string		"_Camera zoom"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				string geo_camera_zoom_min_label
				{
					string		"_Min"
					pos			"260 5"
					size		"40 20"
					font		"f_verysmall_bold"
					color		"1 1 1 0.5"
					contentalign	ALIGN_CR
				}

				selectbox geo_camera_zoom_min
				{
					{
						cvar			*cvar:cl_mapzoommin
						pos				"305 5"
						size			"60 20"
						contentalign	ALIGN_CL
					}
					option geocamzoom_min00
					{
						label	"0.0"
						value	"0"
					}
					option geocamzoom_min020
					{
						label	"0.2"
						value	"0.20"
					}
					option geocamzoom_min040
					{
						label	"0.4"
						value	"0.40"
					}
					option geocamzoom_min060
					{
						label	"0.6"
						value	"0.60"
					}
					option geocamzoom_min080
					{
						label	"0.8"
						value	"0.80"
					}
					option geocamzoom_min100
					{
						label	"_1.0"
						value	"1.0"
					}
				}

				string geo_camera_zoom_max_label
				{
					string		"_Max"
					pos			"405 5"
					size		"40 20"
					font		"f_verysmall_bold"
					color		"1 1 1 0.5"
				}

				selectbox geocamzoom_max
				{
					{
						cvar		*cvar:cl_mapzoommax
						pos			"440 5"
						size		"50 20"
					}
					option geocamzoom_max20
					{
						label	"_2"
						value	"2.0"
					}
					option geocamzoom_max40
					{
						label	"_4"
						value	"4.0"
					}
					option geocamzoom_max60
					{
						label	"_6"
						value	"6.0"
					}
					option geocamzoom_max80
					{
						label	"_8"
						value	"8.0"
					}
					option geocamzoom_max100
					{
						label	"_10"
						value	"10.0"
					}
					option geocamzoom_max120
					{
						label	"_12"
						value	"12.0"
					}
				}
			}

			// Show FPS
			panel show_fps
			{
				{
					pos		"512 200"
					size	"512 30"
					onMouseEnter 	{ *node:this.show_fps_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.show_fps_label@color = "1 1 1 0.5" }
				}

				string show_fps_label
				{
					string		"_Display FPS"
					tooltip		"_Display the number of frames rendered per second"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox show_fps_opt
				{
					current		*cvar:cl_fps
					pos			"472 6"
					size		"20 18"
				}
			}

			// Show FPS
			panel intro_video
			{
				{
					pos		"512 230"
					size	"512 30"
					onMouseEnter 	{ *node:this.intro_video_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.intro_video_label@color = "1 1 1 0.5" }
				}

				string intro_video_label
				{
					string		"_Skip Intro Video"
					tooltip		"_Don't play the video when loading the game."
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox intro_video_opt
				{
					current		*cvar:cl_introshown
					pos			"472 6"
					size		"20 18"
				}
			}
		}

		// ==================
		// VIDEO OPTIONS MENU
		// ==================
		panel opts_video
		{
			{
				pos 	"0 40"
				size	"1024 365"
				invis	true
			}

			panel resolution
			{
				{
					pos 	"0 0"
					size	"512 30"
					onMouseEnter 	{ *node:this.resolution_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.resolution_label@color = "1 1 1 0.5" }
				}

				string resolution_label
				{
					string		"_Resolution"
					pos			"5 5"
					size		"150 20"
					color		"1 1 1 0.5"
				}

				string ratio_label
				{
					string		"_Ratio"
					pos			"200 5"
					size		"40 20"
					font		"f_verysmall_bold"
					color		"1 1 1 0.5"
				}

				selectbox select_ratio
				{
					{
						tooltip		"_Display resolutions in this ratio"
						cvar		*cvar:mn_vidratio
						pos			"250 5"
						size		"80 20"
						onChange {	cmd "cl_setratiofilter <cvar:mn_vidratio>"	}
					}
					option all
					{
						label	"_All"
						value	"all"
					}
					option r5_4
					{
						label	"5:4"
						value	"1.25"
					}
					option r4_3
					{
						label	"4:3"
						value	"1.3333333"
					}
					option r3_2
					{
						label	"3:2"
						value	"1.5"
					}
					option r16_10
					{
						label	"16:10"
						value	"1.6"
					}
					option r16_9
					{
						label	"16:9"
						value	"1.7777777"
					}
					option custom
					{
						label	"_Others"
						value	"custom"
					}
				}

				selectbox select_res
				{
					cvar		*cvar:vid_mode
					pos			"340 5"
					size		"152 20"
					dataid		OPTION_VIDEO_RESOLUTIONS
				}
			}

			// Full screen or windowed mode
			panel fullscreen
			{
				{
					pos		"0 30"
					size	"512 30"
					onMouseEnter 	{ *node:this.fullscreen_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.fullscreen_label@color = "1 1 1 0.5" }
				}

				string fullscreen_label
				{
					string		"_Fullscreen"
					tooltip		"_View the game in fullscreen instead of windowed mode"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox fullscreen_opt
				{
					current		*cvar:vid_fullscreen
					pos			"472 6"
					size		"20 18"
				}
			}

			// Full screen or windowed mode
			panel stretch
			{
				{
					pos		"0 60"
					size	"512 30"
					onMouseEnter 	{ *node:this.stretch_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.stretch_label@color = "1 1 1 0.5" }
				}

				string stretch_label
				{
					string		"_Stretch screen"
					tooltip		"_Stretch screen to fit monitors with 4:3 ratio"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox stretch_opt
				{
					current		*cvar:vid_stretch
					pos			"472 6"
					size		"20 18"
				}
			}

			// Gamma / Brightness
			panel gamma
			{
				{
					pos		"0 90"
					size	"512 30"
					onMouseEnter 	{ *node:this.gamma_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.gamma_label@color = "1 1 1 0.5" }
				}

				string gamma_label
				{
					string		"_Gamma / Brightness"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				bar gamma_bar
				{
					current		*cvar:vid_gamma
					pos			"237 11"
					size		"251 8"
					color		"0.582 0.808 0.758 1"
					border		"1"
					bordercolor	"0.582 0.808 0.758 1"
					max			3.0
					onClick		{ }
				}
			}

			// Sunlight brightness on geoscape
			panel geo_sun
			{
				{
					pos		"0 120"
					size	"512 30"
					onMouseEnter 	{ *node:this.geo_sun_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.geo_sun_label@color = "1 1 1 0.5" }
				}

				string geo_sun_label
				{
					string		"_Geoscape sunlight"
					tooltip		"_Brightness of sunlight on the geoscape"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				bar geo_sun_bar
				{
					current		*cvar:cl_3dmapAmbient
					pos			"237 11"
					size		"251 8"
					color		"0.582 0.808 0.758 1"
					border		"1"
					bordercolor	"0.582 0.808 0.758 1"
					min			-1
					max			3
					onClick		{ }
				}
			}

			// Screenshot settings
			panel screenshot
			{
				{
					pos		"0 150"
					size	"512 60"
					onMouseEnter 	{ *node:this.screenshot_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.screenshot_label@color = "1 1 1 0.5" }
				}

				string screenshot_label
				{
					string		"_Screenshot format"
					tooltip		"_The file format screenshots will be saved in"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				selectbox screenshot_format
				{
					{
						cvar		*cvar:r_screenshot_format
						pos			"367 5"
						size		"125 20"
						onChange	{
							call *node:root.opts_windows.opts_video.hide_screenshot_quality
						}
					}
					option screenshot_format_jpeg
					{
						label	"jpg"
						value	"jpg"
					}
					option screenshot_format_png
					{
						label	"png"
						value	"png"
					}
					option screenshot_format_tga
					{
						label	"tga"
						value	"tga"
					}
				}
			}

			// Screenshot quality
			panel screenshot_quality
			{
				{
					pos		"0 210"
					size	"512 30"
					invis	true
					onMouseEnter 	{ *node:this.screenshot_quality_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.screenshot_quality_label@color = "1 1 1 0.5" }
				}

				string screenshot_quality_label
				{
					string		"_Screenshot quality"
					font		"f_verysmall_bold"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				bar screenshot_quality_bar
				{
					current		*cvar:r_screenshot_jpeg_quality
					pos			"237 11"
					size		"251 8"
					color		"0.582 0.808 0.758 1"
					border		"1"
					bordercolor	"0.582 0.808 0.758 1"
					max			100
					onClick		{ }
				}
			}

			// Hide screenshot quality if JPG not selected
			func hide_screenshot_quality {
				if ( *cvar:r_screenshot_format eq "jpg" ) {
					*node:parent.screenshot_quality@invis = false
				} else {
					*node:parent.screenshot_quality@invis = true
				}
			}

			// Buttons to set low/med/high video configurations
			panel video_auto
			{
				{
					pos		"5 275"
					size	"487 100"
					bgcolor		"0 0 0 0.5"
					onMouseEnter 	{ *node:this.video_auto_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.video_auto_label@color = "1 1 1 0.5" }
				}

				string video_auto_label
				{
					string		"_Video quality"
					pos			"5 10"
					size		"482 30"
				}
				string video_auto_desc
				{
					string		"_Default video configuration settings"
					pos			"5 30"
					size		"492 15"
					font		"f_verysmall"
					color		"1 1 1 0.5"
					contentalign	ALIGN_CL
				}

				MainMenu3Btn video_low
				{
					pos			"5 55"
					size		"140 30"
					string		"_LOW"
					font		"f_small_bold"
					onClick
					{
						cmd "exec video-low.cfg;"
					}
				}

				MainMenu3Btn video_medium
				{
					pos		"171 55"
					size	"140 30"
					string	"_MEDIUM"
					font		"f_small_bold"
					onClick
					{
						cmd "exec video-medium.cfg;"
					}
				}

				MainMenu3Btn video_high
				{
					pos		"337 55"
					size	"140 30"
					string	"_HIGH"
					font		"f_small_bold"
					onClick
					{
						cmd "exec video-high.cfg;"
					}
				}
			}

			// =============
			// VIDEO OPTIONS
			// Second Column
			// =============

			// Turn GLSL on/off
			panel shaders
			{
				{
					pos			"512 0"
					size		"512 90"
					onMouseEnter 	{ *node:this.shaders_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.shaders_label@color = "1 1 1 0.5" }
				}

				string shaders_label
				{
					string		"_Shaders"
					tooltip		"_Enhanced visual techniques like post-processing effects"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox shaders_opt
				{
					current		*cvar:r_programs
					pos			"472 6"
					size		"20 18"
					onClick		{ call *node:root.toggle_shaders_opts }
				}

				// Turn post-processing shader effects on/off
				panel postprocessing
				{
					{
						pos			"0 30"
						size		"512 30"
						invis		true
						onMouseEnter 	{ *node:this.postprocessing_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.postprocessing_label@color = "1 1 1 0.5" }
					}

					string postprocessing_label
					{
						string		"_Post-processing effects"
						tooltip		"_Effects like light bloom and reflected light"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					CheckBox postprocessing_opt
					{
						current		*cvar:r_postprocess
						pos			"472 6"
						size		"20 18"
					}
				}

				// Button to view advanced OpenGL options
				MainMenu2Btn opengl_adv_btn
				{
					string			"_Advanced OpenGL options"
					pos				"300 65"
					size			"192 20"
					invis			true
					font			"f_verysmall_bold"
					selectcolor		"0 0 0 0.9"
					onClick			{ call *node:root.toggle_panel("opengl_adv", 1) }
				}
			}

			// Turn real-time lighting on/off
			panel light_realtime
			{
				{
					pos			"512 90"
					size		"512 90"
					onMouseEnter 	{ *node:this.light_realtime_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.light_realtime_label@color = "1 1 1 0.5" }
				}

				string light_realtime_label
				{
					string		"_Real-time lighting effects"
					pos			"5 5"
					size		"250 20"
					color		"1 1 1 0.5"
				}

				CheckBox light_realtime_opt
				{
					current		*cvar:r_lights
					pos			"472 6"
					size		"20 18"
					onClick		{
						call *node:root.opts_windows.opts_video.light_realtime.toggle_realtime_lighting_opts
					}
				}

				// The number of dynamic lights
				panel light_realtime_count
				{
					{
						pos			"0 30"
						size		"512 30"
						invis		true
						onMouseEnter 	{ *node:this.light_realtime_count_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.light_realtime_count_label@color = "1 1 1 0.5" }
					}

					string light_realtime_count_label
					{
						string		"_Max dynamic lights"
						tooltip		"_Set available hardware-accelerated dynamic lights"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					string dynamiclights_value
					{
						string		*cvar:r_dynamic_lights
						pos			"452 5"
						size		"40 20"
					}

					Spinner dynamiclights_change
					{
						current		*cvar:r_dynamic_lights
						pos			"472 6"
						width		20
						height		25
						min			0
						max			8
						delta		1
					}
				}

				// Bumpmapping / Normalmapping
				panel light_bumpmapping
				{
					{
						pos			"0 60"
						size		"512 30"
						invis		true
						onMouseEnter 	{ *node:this.light_bumpmapping_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.light_bumpmapping_label@color = "1 1 1 0.5" }
					}

					string light_bumpmapping_label
					{
						string		"_Bumpmapping / Normalmapping"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"250 20"
						color		"1 1 1 0.5"
					}

					CheckBox light_bumpmapping_opt
					{
						current		*cvar:r_bumpmap
						pos			"472 6"
						size		"20 18"
					}
				}

				// Display or hide the real-time lighting options
				func toggle_realtime_lighting_opts {
					if ( *cvar:r_lights >= 1 ) {
						*node:parent.light_realtime_count@invis = false
						*node:parent.light_bumpmapping@invis = false
					} else {
						*node:parent.light_realtime_count@invis = true
						*node:parent.light_bumpmapping@invis = true
					}
				}
			}

			// Environmental effects (weather, material system, coronas, etc.)
			panel env_effects
			{
				{
					pos			"512 210"
					size		"512 60"
					onMouseEnter 	{ *node:this.env_effects_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.env_effects_label@color = "1 1 1 0.5" }
				}

				string env_effects_label
				{
					string		"_Environmental effects"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				string env_effects_coronas_label
				{
					string		"_Coronas"
					tooltip		"_Lighting effect"
					font		"f_verysmall_bold"
					contentalign	ALIGN_CR
					pos			"190 5"
					size		"75 20"
					color		"1 1 1 0.5"
					onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
				}
				CheckBox env_effects_coronas_opt
				{
					current		*cvar:r_coronas
					pos			"270 6"
					size		"20 18"
				}

				string env_effects_fog_label
				{
					string		"_Fog"
					tooltip		"_Fades distant objects on the battlescape"
					font		"f_verysmall_bold"
					contentalign	ALIGN_CR
					pos			"290 5"
					size		"75 20"
					color		"1 1 1 0.5"
					onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
				}
				CheckBox env_effects_fog_opt
				{
					current		*cvar:r_fog
					pos			"370 6"
					size		"20 18"
				}

				string env_effects_weather_label
				{
					string		"_Weather"
					tooltip		"_Rain and snow on the battlescape"
					font		"f_verysmall_bold"
					contentalign	ALIGN_CR
					pos			"390 5"
					size		"75 20"
					color		"1 1 1 0.5"
					onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
				}
				CheckBox env_effects_weather_opt
				{
					current		*cvar:cl_particleweather
					pos			"472 6"
					size		"20 18"
				}

				string env_effects_flares_label
				{
					string		"_Flares"
					tooltip		"_Light reflections"
					font		"f_verysmall_bold"
					contentalign	ALIGN_CR
					pos			"390 35"
					size		"75 20"
					color		"1 1 1 0.5"
					onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
				}
				CheckBox env_effects_flares_opt
				{
					current		*cvar:r_flares
					pos			"472 36"
					size		"20 18"
				}

				string env_effects_materials_label
				{
					string		"_Materials"
					tooltip		"_Texture animations, blending and other effects"
					font		"f_verysmall_bold"
					contentalign	ALIGN_CR
					pos			"290 35"
					size		"75 20"
					color		"1 1 1 0.5"
					onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
				}
				CheckBox env_effects_materials_opt
				{
					current		*cvar:r_materials
					pos			"370 36"
					size		"20 18"
				}
			}

			// Advanced Video Options Button
			panel video_adv_line
			{
				{
					pos			"512 285"
					size		"512 30"
					onMouseEnter 	{ *node:this.video_adv_line_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.video_adv_line_label@color = "1 1 1 0.5" }
				}

				string video_adv_line_label
				{
					string		"_Video performance"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				MainMenu2Btn video_adv_line_btn
				{
					string			"_Advanced Video Options"
					pos				"300 5"
					size			"192 20"
					font			"f_verysmall_bold"
					selectcolor		"0 0 0 0.9"
					onClick			{ call *node:root.toggle_panel("video_adv", 1) }
				}
			}
		}

		// ==================
		// SOUND OPTIONS MENU
		// ==================
		panel opts_sound
		{
			{
				pos 	"0 40"
				size	"1024 365"
				invis	true
			}

			// Enable/disable audio
			panel audio_toggle
			{
				{
					pos		"0 0"
					size	"512 30"
					onMouseEnter 	{ *node:this.audio_toggle_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.audio_toggle_label@color = "1 1 1 0.5" }
				}

				string audio_toggle_label
				{
					string		"_Enable audio"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox audio_toggle_opt
				{
					current		*cvar:snd_init
					pos			"472 6"
					size		"20 18"
				}
			}

			// Music volume
			panel audio_music
			{
				{
					pos		"0 30"
					size	"512 30"
					onMouseEnter 	{ *node:this.audio_music_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.audio_music_label@color = "1 1 1 0.5" }
					visiblewhen		"*cvar:snd_init"
				}

				string audio_music_label
				{
					string		"_Music volume"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				bar audio_music_bar
				{
					current		*cvar:snd_music_volume
					pos			"237 11"
					size		"251 8"
					color		"0.582 0.808 0.758 1"
					border		"1"
					bordercolor	"0.582 0.808 0.758 1"
					max			128
					onClick		{ }
				}
			}

			// Enable/disable music
			panel audio_music_toggle
			{
				{
					pos		"0 60"
					size	"512 30"
					onMouseEnter 	{ *node:this.audio_music_toggle_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.audio_music_toggle_label@color = "1 1 1 0.5" }
					visiblewhen		"*cvar:snd_init"
				}

				string audio_music_toggle_label
				{
					string		"_Enable music"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox audio_music_toggle_opt
				{
					current		*cvar:snd_music_play
					pos			"472 6"
					size		"20 18"
				}
			}

			// Sound effects volume
			panel audio_effects_volume
			{
				{
					pos		"0 90"
					size	"512 30"
					onMouseEnter 	{ *node:this.audio_effects_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.audio_effects_label@color = "1 1 1 0.5" }
					visiblewhen		"*cvar:snd_init"
				}

				string audio_effects_label
				{
					string		"_Sound effects"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				bar audio_effects_bar
				{
					current		*cvar:snd_volume
					pos			"237 11"
					size		"251 8"
					color		"0.582 0.808 0.758 1"
					border		"1"
					bordercolor	"0.582 0.808 0.758 1"
					max			1.0
					onClick		{ }
				}
			}

			// Enable/disable menu sounds
			panel audio_menu
			{
				{
					pos		"0 120"
					size	"512 30"
					onMouseEnter 	{ *node:this.audio_menu_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.audio_menu_label@color = "1 1 1 0.5" }
					visiblewhen		"*cvar:snd_init"
				}

				string audio_menu_label
				{
					string		"_Menu sounds"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox audio_menu_opt
				{
					current		*cvar:ui_sounds
					pos			"472 6"
					size		"20 18"
				}
			}

			// Audio sample rate
			panel audio_sample
			{
				{
					pos		"0 180"
					size	"512 60"
					onMouseEnter 	{ *node:this.audio_sample_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.audio_sample_label@color = "1 1 1 0.5" }
					visiblewhen		"*cvar:snd_init"
				}

				string audio_sample_label
				{
					string		"_Audio sample rate"
					tooltip		"_Higher sample rates provide better audio quality"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				selectbox audio_sample_opt
				{
					{
						cvar		*cvar:snd_rate
						pos			"367 5"
						size		"125 20"
					}
					option low_value
					{
						label	"_11025 kHz"
						value	"11025"
					}
					option medium_value
					{
						label	"_22050 kHz"
						value	"22050"
					}
					option normal_value
					{
						label	"_44100 kHz"
						value	"44100"
					}
					option high_value
					{
						label	"_48000 kHz"
						value	"48000"
					}
				}

				MainMenu2Btn video_adv_line_btn
				{
					string			"_Apply Sample Rate"
					pos				"300 35"
					size			"192 20"
					font			"f_verysmall_bold"
					selectcolor		"0 0 0 0.9"
					onClick			{ cmd "snd_restart;" }
					visiblewhen		"*cvar:snd_init"
				}
			}
		}

		// ==================
		// SHOW KEY BINDINGS
		// ==================
		panel opts_keys
		{
			{
				pos 	"6 40"
				size	"1018 365"
				invis	true
				layout	LAYOUT_LEFT_RIGHT_FLOW
				layoutmargin 3
			}
			KeyList keylist0 {
			}
			KeyList keylist1 {
			}
			KeyList keylist2 {
			}
		}

		// ====================
		// GAMPLAY OPTIONS MENU
		// ====================
		panel opts_gameplay
		{
			{
				pos 	"0 40"
				size	"1024 365"
				invis	true
			}

			// Battlescape camera settings
			panel battle_camera
			{
				{
					pos		"0 0"
					size	"512 270"
					onMouseEnter 	{ *node:this.battle_camera_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.battle_camera_label@color = "1 1 1 0.5" }
				}

				string battle_camera_label
				{
					string		"_Battlescape view configuration"
					pos			"5 5"
					size		"300 20"
					color		"1 1 1 0.5"
				}

				// Camera rotation speed
				panel camera_speed
				{
					{
						pos		"0 30"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_speed_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_speed_label@color = "1 1 1 0.5" }
					}

					string camera_speed_label
					{
						string		"_Scroll speed"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					bar camera_speed_bar
					{
						current		*cvar:cl_cammovespeed
						pos			"237 11"
						size		"251 8"
						color		"0.582 0.808 0.758 1"
						border		"1"
						bordercolor	"0.582 0.808 0.758 1"
						min			5
						max			3000
						onClick		{ }
					}
				}

				// Camera rotation speed
				panel camera_rot_speed
				{
					{
						pos		"0 60"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_rot_speed_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_rot_speed_label@color = "1 1 1 0.5" }
					}

					string camera_rot_speed_label
					{
						string		"_Rotation speed"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					bar camera_rot_speed_bar
					{
						current		*cvar:cl_camrotspeed
						pos			"237 11"
						size		"251 8"
						color		"0.582 0.808 0.758 1"
						border		"1"
						bordercolor	"0.582 0.808 0.758 1"
						min			5
						max			1000
						onClick		{ }
					}
				}

				// Camera deceleration speed
				panel camera_dec_speed
				{
					{
						pos		"0 90"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_dec_speed_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_dec_speed_label@color = "1 1 1 0.5" }
					}

					string camera_dec_speed_label
					{
						string		"_Inertia"
						tooltip		"_Higher values will cause the camera to stop more gradually"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					bar camera_dec_speed_bar
					{
						current		*cvar:cl_cammoveaccel
						pos			"237 11"
						size		"251 8"
						color		"0.582 0.808 0.758 1"
						border		"1"
						bordercolor	"0.582 0.808 0.758 1"
						min			0
						max			3000
						onClick		{ }
					}
				}

				// Camera pitch minimum and maximum
				panel camera_pitch
				{
					{
						pos		"0 120"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_pitch_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_pitch_label@color = "1 1 1 0.5" }
					}

					string camera_pitch_label
					{
						string		"_Pitch"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					string camera_pitch_min_label
					{
						string			"_Min"
						tooltip			"_Maps optimized for values above 10"
						pos				"260 5"
						size			"40 20"
						font			"f_verysmall_bold"
						contentalign	ALIGN_CR
						color			"1 1 1 0.5"
						onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
					}

					selectbox camera_pitch_min_opt
					{
						{
							cvar		*cvar:cl_campitchmin
							pos			"300 5"
							size		"70 20"
							contentalign	ALIGN_CR
						}
						option minus90degrees
						{
							label	"-90"
							value	"-90"
						}
						option minus45degrees
						{
							label	"-45"
							value	"-45"
						}
						option minus15degrees
						{
							label	"-15"
							value	"-15"
						}
						option plus0degrees
						{
							label	"0"
							value	"0"
						}
						// default
						option plus10degrees
						{
							label	"10"
							value	"10"
						}
						option plus15degrees
						{
							label	"15"
							value	"15"
						}
						option plus45degrees
						{
							label	"45"
							value	"45"
						}
					}

					string camera_pitch_max_label
					{
						string			"_Max"
						tooltip			"_Values above 90 will result in inverted views"
						pos				"382 5"
						size			"40 20"
						font			"f_verysmall_bold"
						contentalign	ALIGN_CR
						color			"1 1 1 0.5"
						onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
					}

					selectbox camera_pitch_max_opt
					{
						{
							cvar		*cvar:cl_campitchmax
							pos			"422 5"
							size		"70 20"
						}
						option plus45degrees
						{
							label	"45"
							value	"45"
						}
						option plus60degrees
						{
							label	"60"
							value	"60"
						}
						option plus75degrees
						{
							label	"75"
							value	"75"
						}
						// default
						option plus89degrees
						{
							label	"89"
							value	"89"
						}
						option plus135degrees
						{
							label	"135"
							value	"135"
						}
						option plus180degrees
						{
							label	"180"
							value	"180"
						}
					}
				}

				// Camera zoom minimum and maximum
				panel camera_zoom
				{
					{
						pos		"0 150"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_zoom_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_zoom_label@color = "1 1 1 0.5" }
					}

					string camera_zoom_label
					{
						string		"_Zoom constraints"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					string camera_zoom_min_label
					{
						string			"_Min"
						pos				"260 5"
						size			"40 20"
						font			"f_verysmall_bold"
						contentalign	ALIGN_CR
						color			"1 1 1 0.5"
						onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
					}

					selectbox camera_zoom_min_opt
					{
						{
							cvar		*cvar:cl_camzoommin
							pos			"300 5"
							size		"70 20"
							contentalign	ALIGN_CR
						}
						option zoom_min0
						{
							label	"0"
							value	"0"
						}
						option zoom_min005
						{
							label	"0.05"
							value	"0.05"
						}
						option zoom_min010
						{
							label	"0.10"
							value	"0.10"
						}
						option zoom_min015
						{
							label	"0.15"
							value	"0.15"
						}
						option zoom_min020
						{
							label	"0.20"
							value	"0.20"
						}
						option zoom_min025
						{
							label	"0.25"
							value	"0.25"
						}
						// default
						option zoom_min030
						{
							label	"0.30"
							value	"0.3"
						}
					}

					string camera_zoom_max_label
					{
						string			"_Max"
						pos				"382 5"
						size			"40 20"
						font			"f_verysmall_bold"
						contentalign	ALIGN_CR
						color			"1 1 1 0.5"
						onMouseEnter 	{ *node:this@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this@color = "1 1 1 0.5" }
					}

					selectbox camera_zoom_max_opt
					{
						{
							cvar		*cvar:cl_camzoommax
							pos			"422 5"
							size		"70 20"
						}
						option zoom_max200
						{
							label	"2"
							value	"2.0"
						}
						// default
						option zoom_max340
						{
							label	"3.4"
							value	"3.4"
						}
						option zoom_max600
						{
							label	"6"
							value	"6.0"
						}
						option zoom_max800
						{
							label	"8"
							value	"8.0"
						}
						option zoom_max1000
						{
							label	"10"
							value	"10.0"
						}
						option zoom_max1200
						{
							label	"12"
							value	"12.0"
						}
					}
				}

				// Camera zoom speed (quant)
				panel camera_zoom_speed
				{
					{
						pos		"0 180"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_zoom_speed_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_zoom_speed_label@color = "1 1 1 0.5" }
					}

					string camera_zoom_speed_label
					{
						string		"_Zoom speed"
						pos			"5 5"
						size		"200 20"
						font		"f_verysmall_bold"
						color		"1 1 1 0.5"
					}

					bar camera_zoom_speed_bar
					{
						current		*cvar:cl_camzoomquant
						pos			"237 11"
						size		"251 8"
						color		"0.582 0.808 0.758 1"
						border		"1"
						bordercolor	"0.582 0.808 0.758 1"
						min			0
						max			0.30
						onClick		{ }
					}
				}

				// Center camera on action
				panel camera_center
				{
					{
						pos		"0 210"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_center_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_center_label@color = "1 1 1 0.5" }
					}

					string camera_center_label
					{
						string		"_Center view"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					CheckBox camera_center_opt
					{
						current		*cvar:cl_centerview
						pos			"472 6"
						size		"20 18"
					}
				}

				// Isometric view
				panel camera_iso
				{
					{
						pos		"0 240"
						size	"512 30"
						onMouseEnter 	{ *node:this.camera_iso_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.camera_iso_label@color = "1 1 1 0.5" }
					}

					string camera_iso_label
					{
						string		"_Isometric view"
						tooltip		"_3D rendering without perspective for an old-school look"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					CheckBox camera_iso_opt
					{
						current		*cvar:r_isometric
						pos			"472 6"
						size		"20 18"
					}
				}
			}

			// ====================
			// GAMPLAY OPTIONS MENU
			// 2nd column
			// ====================
			panel battle_gameplay
			{
				{
					pos		"512 0"
					size	"512 150"
					onMouseEnter 	{ *node:this.battle_gameplay_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.battle_gameplay_label@color = "1 1 1 0.5" }
				}

				string battle_gameplay_label
				{
					string		"_Battlescape gameplay options"
					pos			"5 5"
					size		"300 20"
					color		"1 1 1 0.5"
				}

				// Actor speed
				panel battle_actor_speed
				{
					{
						pos		"0 30"
						size	"512 30"
						onMouseEnter 	{ *node:this.battle_actor_speed_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.battle_actor_speed_label@color = "1 1 1 0.5" }
					}

					string battle_actor_speed_label
					{
						string		"_Actor speed"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					bar battle_actor_speed_bar
					{
						current		*cvar:g_actorspeed
						pos			"237 11"
						size		"251 8"
						color		"0.582 0.808 0.758 1"
						border		"1"
						bordercolor	"0.582 0.808 0.758 1"
						max			9
						onClick		{ }
					}
				}

				// Confirm actions
				panel battle_confirm
				{
					{
						pos		"0 60"
						size	"512 30"
						onMouseEnter 	{ *node:this.battle_confirm_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.battle_confirm_label@color = "1 1 1 0.5" }
					}

					string battle_confirm_label
					{
						string		"_Confirm actions"
						tooltip		"_Confirm your actions on the battlefield before committing"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					selectbox battle_confirm_opt
					{
						{
							cvar		*cvar:confirm_actions
							pos			"342 5"
							size		"150 20"
						}
						option confirm_value {
							label	"_Never"
							value	"0"
						}
						option noconfirm_value {
							label	"_When moving"
							value	"2"
						}
						option moveconfirm_value {
							label	"_Always"
							value	"1"
						}
					}
				}

				// Auto-stand
				panel battle_autostand
				{
					{
						pos		"0 90"
						size	"512 30"
						onMouseEnter 	{ *node:this.battle_autostand_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.battle_autostand_label@color = "1 1 1 0.5" }
					}

					string battle_autostand_label
					{
						string		"_Stand when moving"
						tooltip		"_Soldiers will automatically stand when ordered to move while they are crouched"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					CheckBox battle_autostand_opt
					{
						current		*cvar:cl_autostand
						pos			"472 6"
						size		"20 18"
					}
				}

				// HUD choice
				panel battle_hud
				{
					{
						pos		"0 120"
						size	"512 30"
						onMouseEnter 	{ *node:this.battle_hud_label@color = "1 1 1 0.9" }
						onMouseLeave 	{ *node:this.battle_hud_label@color = "1 1 1 0.5" }
					}

					string battle_hud_label
					{
						string		"_Battlescape interface"
						font		"f_verysmall_bold"
						pos			"5 5"
						size		"200 20"
						color		"1 1 1 0.5"
					}

					selectbox battle_hud_opt
					{
						cvar		*cvar:cl_hud
						pos			"312 5"
						size		"180 20"
					}
					/**
					 * Add a hud window the user can use to play battlescape
					 * <1> HUD identifier name
					 * <2> HUD label
					 */
					confunc add_hud_name {
						call *node:parent.battle_hud_opt@createchild("option<1>", "option")
						*node:parent.battle_hud_opt.option<1>@value = <1>
						*node:parent.battle_hud_opt.option<1>@label = <2>
					}
				}
			}
		}
	}

	// Fuzzy screen effect (see assets.ufo)
	fuzzyScreen overlay { }

	// Advanced Video Options Window
	panel video_adv
	{
		{
			pos		"0 0"
			size	"1024 768"
			invis	true
			bgcolor	"0 0 0 0.9"
			onClick		{ call *node:root.toggle_panel("video_adv", 0) }
		}
		panel video_adv_window
		{
			{
				pos		"256 128"
				size	"512 512"
				bgcolor	"0.4 0.52 0.5 0.4"
			}
			string opengl_adv_label
			{
				string			"_Advanced Video options"
				pos				"0 0"
				size			"512 40"
				font			"f_small_bold"
				color			"0.065 0.065 0.065 1"
				bgcolor			"0.53 0.61 0.21 1"
				contentalign	ALIGN_CC
			}

			// Texture resolution
			panel tex_res
			{
				{
					pos		"10 50"
					size	"492 30"
					onMouseEnter 	{ *node:this.tex_res_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.tex_res_label@color = "1 1 1 0.5" }
				}

				string tex_res_label
				{
					string		"_Max texture resolution"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				selectbox tex_res_opt
				{
					{
						cvar		*cvar:r_maxtexres
						pos			"367 5"
						size		"125 20"
					}
					option o256 {
						label	"_256"
						value	"256"
					}
					option o512 {
						label	"_512"
						value	"512"
					}
					option o1024 {
						label	"_1024"
						value	"1024"
					}
					option o2048 {
						label	"_2048"
						value	"2048"
					}
					option o4096 {
						label	"_4096"
						value	"4096"
					}
					option o8192 {
						label	"_8192"
						value	"8192"
					}
				}
			}

			// Texture filtering
			panel tex_filtering
			{
				{
					pos		"10 80"
					size	"492 30"
					onMouseEnter 	{ *node:this.tex_filtering_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.tex_filtering_label@color = "1 1 1 0.5" }
				}

				string tex_filtering_label
				{
					string		"_Texture filtering"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				selectbox tex_filtering_opt
				{
					{
						cvar		*cvar:r_texturemode
						pos			"242 5"
						size		"250 20"
					}
					option nearest {
						label	"_None"
						value	"GL_NEAREST"
					}
					option linear {
						label	"_Bilinear only"
						value	"GL_LINEAR"
					}
					option nearest_mipmap_nearest {
						label	"_Mipmaps only"
						value	"GL_NEAREST_MIPMAP_NEAREST"
					}
					option linear_mipmap_nearest {
						label	"_Bilinear and mipmaps"
						value	"GL_LINEAR_MIPMAP_NEAREST"
					}
					option nearest_mipmap_linear {
						label	"_Trilinear and mipmaps"
						value	"GL_NEAREST_MIPMAP_LINEAR"
					}
					option linear_mipmap_linear {
						label	"_Bi-/trilinear and mipmaps"
						value	"GL_LINEAR_MIPMAP_LINEAR"
					}
				}
			}

			// Texture compression
			panel tex_compression
			{
				{
					pos		"10 110"
					size	"492 30"
					onMouseEnter 	{ *node:this.tex_compression_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.tex_compression_label@color = "1 1 1 0.5" }
				}

				string tex_compression_label
				{
					string		"_Texture compression"
					tooltip		"_Improves memory performance but reduces visual quality"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox tex_compression_opt
				{
					current		*cvar:r_ext_texture_compression
					pos			"472 6"
					size		"20 18"
				}
			}

			// Texture level of detail (LOD)
			panel tex_lod
			{
				{
					pos		"10 140"
					size	"492 30"
					onMouseEnter 	{ *node:this.tex_lod_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.tex_lod_label@color = "1 1 1 0.5" }
				}

				string tex_lod_label
				{
					string		"_LOD"
					tooltip		"_Reduce distant texture sizes for better performance"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox tex_lod_opt
				{
					current		*cvar:r_texture_lod
					pos			"472 6"
					size		"20 18"
				}
			}

			// Anisotropic filtering
			panel tex_aniso
			{
				{
					pos			"10 170"
					size		"492 30"
					onMouseEnter 	{ *node:this.tex_aniso_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.tex_aniso_label@color = "1 1 1 0.5" }
				}

				string tex_aniso_label
				{
					string		"_Anisotropic filtering"
					tooltip		"_Distant textures appear sharper at higher resolutions"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				string tex_aniso_value
				{
					string		*cvar:r_anisotropic
					pos			"452 5"
					size		"40 20"
				}

				Spinner tex_aniso_change
				{
					current		*cvar:r_anisotropic
					pos			"472 6"
					min			0
					max			16
					delta		1
				}
			}

			// Texture filtering
			panel lightmap_res
			{
				{
					pos		"10 200"
					size	"512 30"
					onMouseEnter 	{ *node:this.lightmap_res_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.lightmap_res_label@color = "1 1 1 0.5" }
				}

				string lightmap_res_label
				{
					string		"_Lightmap size"
					tooltip		"_High resolution creates smoother shadows"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				selectbox lightmap_res_opt
				{
					{
						cvar		*cvar:r_maxlightmap
						pos			"367 5"
						size		"125 20"
					}
					option o256 {
						label	"_256"
						value	"256"
					}
					option o512 {
						label	"_512"
						value	"512"
					}
					option o1024 {
						label	"_1024"
						value	"1024"
					}
					option o2048 {
						label	"_2048"
						value	"2048"
					}
				}
			}

			// Lightmap brightness
			panel lightmap_bright
			{
				{
					pos		"10 230"
					size	"512 30"
					onMouseEnter 	{ *node:this.lightmap_bright_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.lightmap_bright_label@color = "1 1 1 0.5" }
				}

				string lightmap_bright_label
				{
					string		"_Lightmap brightness"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				bar lightmap_bright_bar
				{
					current		*cvar:r_modulate
					pos			"241 11"
					size		"251 8"
					color		"0.582 0.808 0.758 1"
					border		"1"
					bordercolor	"0.582 0.808 0.758 1"
					max			4.0
					onClick		{ }
				}
			}

			// Done button
			MainMenuExitBtn done_btn
			{
				size 			"250 30"
				pos 			"262 482"
				string			"_DONE"
				onClick			{ call *node:root.toggle_panel("video_adv", 0) }
			}

			// Fuzzy screen effect (see assets.ufo)
			fuzzyScreen overlay { }
		}
	}

	// Advanced OpenGL options
	panel opengl_adv
	{
		{
			pos		"0 0"
			size	"1024 768"
			invis	true
			bgcolor	"0 0 0 0.9"
			onClick			{ call *node:root.toggle_panel("opengl_adv", 0) }
		}
		panel opengl_adv_opts
		{
			{
				pos			"256 256"
				size		"512 256"
				bgcolor		"0.4 0.52 0.5 0.4"
			}
			string opengl_adv_label
			{
				string			"_Advanced OpenGL options"
				pos				"0 0"
				size			"512 40"
				font			"f_small_bold"
				color			"0.065 0.065 0.065 1"
				bgcolor			"0.53 0.61 0.21 1"
				contentalign	ALIGN_CC
			}

			// Vertex buffers
			panel vertexbuffers
			{
				{
					pos		"10 70"
					size	"492 30"
					onMouseEnter 	{ *node:this.vertexbuffers_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.vertexbuffers_label@color = "1 1 1 0.5" }
				}

				string vertexbuffers_label
				{
					string		"_Vertex Buffers"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				CheckBox vertexbuffers_opt
				{
					current		*cvar:r_vertexbuffers
					pos			"472 6"
					size		"20 18"
				}
			}

			// Multisample buffers
			panel multisamplebuffers
			{
				{
					pos			"10 100"
					size		"492 30"
					onMouseEnter 	{ *node:this.multisamplebuffers_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.multisamplebuffers_label@color = "1 1 1 0.5" }
				}

				string multisamplebuffers_label
				{
					string		"_Multisample Buffers"
					tooltip		"_Antialias GL primitives (more buffers create smoother edges)"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				string multisamplebuffers_value
				{
					string		*cvar:r_multisample
					pos			"452 5"
					size		"40 20"
				}

				Spinner multisamplebuffers_change
				{
					current		*cvar:r_multisample
					pos			"472 6"
					min			0
					max			4
					delta		1
				}
			}

			// Swap control for multisample buffers
			panel swapinterval
			{
				{
					pos			"10 130"
					size		"492 30"
					onMouseEnter 	{ *node:this.swapinterval_label@color = "1 1 1 0.9" }
					onMouseLeave 	{ *node:this.swapinterval_label@color = "1 1 1 0.5" }
				}

				string swapinterval_label
				{
					string		"_Swap Interval"
					tooltip		"_Higher values will typically provide better results"
					pos			"5 5"
					size		"200 20"
					color		"1 1 1 0.5"
				}

				string swapinterval_value
				{
					string		*cvar:r_swapinterval
					pos			"452 5"
					size		"40 20"
				}

				Spinner swapinterval_change
				{
					current		*cvar:r_swapinterval
					pos			"472 6"
					min			0
					max			2
					delta		1
				}
			}
			MainMenuExitBtn done_btn
			{
				size 			"250 30"
				pos 			"262 226"
				string			"_DONE"
				onClick			{ call *node:root.toggle_panel("opengl_adv", 0) }
			}

			// Fuzzy screen effect (see assets.ufo)
			fuzzyScreen overlay { }
		}
	}

	// Display or hide the GLSL options
	func toggle_shaders_opts {
		if ( *cvar:r_programs == 1 ) {
			*node:root.opts_windows.opts_video.shaders.postprocessing@invis = false
			*node:root.opts_windows.opts_video.shaders.opengl_adv_btn@invis = false
		} else {
			*node:root.opts_windows.opts_video.shaders.postprocessing@invis = true
			*node:root.opts_windows.opts_video.shaders.opengl_adv_btn@invis = true
		}
	}

	/**
	 * @brief Toggles specified panel visibility
	 * @param <1> The panel id
	 * @param <2> 0 or 1 to hide/show the panel
	 */
	func toggle_panel {
		if (<2> eq 1) {
			*node:parent.<1>@invis = false
		} else {
			*node:parent.<1>@invis = true
		}
	}
	/*
	 * @brief Confunc to add a keybinding entry
	 * <1> id
	 * <2> keyspace menu = 0, global = 1 or battlescape = 2
	 * <3> the key name
	 * <4> description
	 */
	confunc keybinding_add {
		call *node:root.opts_windows.opts_keys.keylist<2>.list.keylist@createChild("key_<1>", "KeyBinding")
		*node:root.opts_windows.opts_keys.keylist<2>.list.keylist.key_<1>.id@integer = <1>
		*node:root.opts_windows.opts_keys.keylist<2>.list.keylist.key_<1>.key@string = "<3>"
		*node:root.opts_windows.opts_keys.keylist<2>.list.keylist.key_<1>.description@string = "<4>"
		*node:root.opts_windows.opts_keys.keylist<2>.list.keylist.key_<1>.description@tooltip = "<4>"
	}
	confunc keybinding_clear {
		call *node:root.opts_windows.opts_keys.keylist0.list.keylist@removeAllChild
		call *node:root.opts_windows.opts_keys.keylist1.list.keylist@removeAllChild
		call *node:root.opts_windows.opts_keys.keylist2.list.keylist@removeAllChild
	}
	func onWindowOpened
	{
		// Checks the screenshot type and hides the quality
		// bar if it's not JPG
		call *node:root.opts_windows.opts_video.hide_screenshot_quality

		// Sets default display of all video ratios so it
		// appears selected in the selectbox
		*cvar:mn_vidratio = "all"

		// Displays or hides the openGL options, the real-time
		// lighting options, and the advanced video options
		call *node:root.toggle_panel("video_adv", 0)
		call *node:root.toggle_panel("opengl_adv", 0)
		call *node:root.toggle_shaders_opts
		call *node:root.opts_windows.opts_video.light_realtime.toggle_realtime_lighting_opts
		cmd "mn_mods;mn_init_keylist;"

		*node:root.opts_windows.opts_keys.keylist0.list.label@string = "_MENU"
		*node:root.opts_windows.opts_keys.keylist1.list.label@string = "_GLOBAL"
		*node:root.opts_windows.opts_keys.keylist2.list.label@string = "_BATTLESCAPE"
	}
}
